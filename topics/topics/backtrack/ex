public TreeNode replaceValueInTree(TreeNode treeNode) {
        Map<Integer, Integer> mapLevelToSum = new HashMap<>();
        calculateLevelOrderSum(treeNode, 0, mapLevelToSum);
        replaceValueInTree(treeNode, null, mapLevelToSum, 0);
        treeNode.val = 0;

        return treeNode;


    }

    public void calculateLevelOrderSum(TreeNode node, int level, Map<Integer, Integer> map) {
        if (node != null) {
            map.merge(level, node.val, Integer::sum);
            calculateLevelOrderSum(node.left, level + 1, map);
            calculateLevelOrderSum(node.right, level + 1, map);
        }
    }

    public TreeNode replaceValueInTree(TreeNode root, TreeNode parent, Map<Integer, Integer> map, int level) {

        if (root == null) return null;
        replaceValueInTree(root.left, root, map, level + 1);
        replaceValueInTree(root.right, root, map, level + 1);

        if (parent != null) {
            int siblingSum = (root.left == null ? 0 : root.left.val) + (root.right == null ? 0 : root.right.val);

            if (root.left != null) {
                root.left.val = map.get(level + 1) - siblingSum;
            }
            if (root.right != null) {
                root.right.val = map.get(level + 1) - siblingSum;
            }
        } else {
            if (root.left != null) {
                root.left.val = 0;
            }
            if (root.right != null) {
                root.right.val = 0;
            }
        }

        return root;
    }